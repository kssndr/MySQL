-- ЗАДАНИЕ 1
-- Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине.
USE shop;
-- SELECT * FROM users;
-- SELECT * FROM orders;
INSERT INTO `users` VALUES (7,'Sherman','1993-10-16','2006-10-30 00:55:05','1982-06-14 03:07:53'),(8,'Rafaela','1973-12-02','1995-05-22 01:42:28','2001-10-11 14:00:17'),(9,'Ariel','2006-08-13','2013-12-10 10:26:57','2008-01-07 06:19:29'),(10,'Cayla','1997-05-29','1995-07-14 16:07:53','1982-05-30 04:43:50'),(11,'Beryl','1977-02-09','1998-08-04 13:37:38','1995-08-18 20:31:20'),(12,'Abner','1998-05-20','1992-11-12 01:58:18','2007-10-23 03:52:42'),(13,'Jarrett','2010-03-12','1976-04-27 04:09:31','1990-02-26 10:10:23'),(14,'Jaquelin','1987-12-04','1973-03-08 08:12:59','2013-07-22 05:52:03'),(15,'Adele','1981-03-09','1994-01-10 03:36:40','1985-03-13 17:20:09'),(16,'Felipe','1988-02-28','1990-11-25 06:59:08','1974-10-31 06:11:22'),(17,'Enrique','1980-01-04','2018-10-30 06:07:53','1976-10-13 07:40:41'),(18,'Christy','1982-07-26','2014-04-25 14:32:36','2014-04-07 13:31:11'),(19,'June','1995-09-07','1999-04-07 05:29:13','2017-01-23 12:25:52'),(20,'Khalil','1980-07-25','2005-07-31 08:12:21','2009-06-28 04:46:08'),(21,'Abbigail','1995-05-06','1986-09-05 06:27:54','1979-07-24 22:19:03'),(22,'Beth','1971-08-17','1991-04-30 05:47:14','2005-10-26 07:31:40'),(23,'Brody','1985-11-17','1988-07-15 01:50:01','1970-01-20 03:04:58'),(24,'Winona','1993-08-15','1980-09-24 05:57:34','1976-11-10 18:45:20'),(25,'Liliane','1985-09-08','1990-08-14 22:09:59','1988-05-01 18:07:58'),(26,'Luis','2012-09-14','2011-03-28 03:01:31','1991-03-20 08:23:16'),(27,'Augustine','1975-12-11','1997-07-06 19:37:16','1988-04-07 06:47:15'),(28,'Dorian','2017-03-20','1971-07-24 10:25:25','2009-01-11 13:02:02'),(29,'Ervin','1976-03-24','1980-12-27 01:13:24','2001-11-06 13:29:23'),(30,'Domenick','1979-08-03','1986-12-20 07:22:19','1979-03-24 06:55:32'),(31,'Anita','2018-09-11','1998-05-12 16:41:30','1990-01-06 11:42:13'),(32,'Janessa','1970-03-01','1988-12-02 02:05:13','1976-07-07 07:11:29'),(33,'Angelita','1973-08-15','1999-10-15 00:07:01','2008-11-08 19:31:43'),(34,'Jonatan','2015-07-13','1998-01-28 01:24:09','1986-04-17 14:08:08'),(35,'Keyshawn','1971-11-18','1985-06-26 22:35:13','1987-12-28 15:13:01'),(36,'Javier','1993-01-08','2003-10-10 01:11:00','1998-01-29 17:09:37'),(37,'Deshaun','2002-06-24','2012-02-18 19:05:49','1971-06-22 15:11:26'),(38,'Betsy','2012-01-12','1991-02-15 00:50:33','2014-09-01 07:06:53'),(39,'Marie','2017-04-03','2013-04-15 11:26:53','1989-03-20 11:33:41'),(40,'Schuyler','2005-05-31','1981-10-11 17:27:15','1991-01-27 17:13:12'),(41,'Lexi','1982-09-28','1971-06-14 03:12:24','1987-11-16 21:20:24'),(42,'Mike','1981-10-01','1991-01-21 18:05:08','2014-11-20 22:36:15'),(43,'Berneice','2013-07-09','1977-11-18 23:48:03','1973-04-07 02:58:44'),(44,'Shemar','1999-07-10','1984-04-05 15:44:38','1974-12-30 09:52:40'),(45,'Mckenzie','1973-10-04','1978-07-24 16:41:29','1983-12-21 04:45:00'),(46,'Lawson','2000-05-01','2001-09-16 04:21:50','1987-10-29 15:30:29'),(47,'Jeramie','2019-11-05','2014-10-10 16:44:04','1972-12-31 10:38:23'),(48,'Quinten','2020-08-20','1998-10-21 09:17:42','2018-08-17 04:54:10'),(49,'Noemi','1970-10-19','2000-07-30 09:23:04','1978-05-20 10:06:11'),(50,'Rowena','1980-12-04','2007-05-19 10:11:55','1979-11-27 15:49:45');
INSERT INTO `orders` VALUES (1,45,'2019-09-10 19:56:59','2017-09-21 17:00:52'),(2,43,'2012-05-23 08:30:02','1976-12-22 04:11:12'),(3,29,'1974-07-11 11:54:28','2004-03-29 23:16:34'),(4,3,'1984-07-07 02:43:58','1977-02-21 09:14:28'),(5,22,'1984-06-12 09:47:42','2021-05-29 03:59:09'),(6,39,'2005-05-22 13:35:02','2017-09-25 23:17:05'),(7,25,'1978-07-27 09:03:12','2012-11-01 22:44:28'),(8,42,'1981-10-18 22:51:20','2005-06-06 08:40:01'),(9,2,'1995-12-01 05:54:13','2013-06-14 03:32:05'),(10,18,'1996-09-08 16:53:37','1996-10-08 09:41:31'),(11,42,'1992-10-02 12:03:30','2004-01-18 20:22:04'),(12,2,'1996-05-17 23:51:41','1984-09-18 15:22:19'),(13,2,'2020-11-19 09:33:45','2000-09-26 15:24:23'),(14,34,'1984-10-11 15:00:55','1985-12-22 22:59:17'),(15,32,'1981-07-01 00:37:01','1984-05-03 08:09:41'),(16,9,'2016-11-05 01:51:53','2021-03-15 01:56:15'),(17,39,'1996-01-07 15:23:30','2013-06-16 16:43:38'),(18,7,'2002-02-27 17:48:55','1971-10-04 01:48:41'),(19,27,'1970-08-04 18:02:11','2008-05-28 01:05:04'),(20,24,'1989-12-27 06:14:59','1976-07-19 11:37:01'),(21,46,'2008-01-18 17:11:03','1972-07-11 11:56:52'),(22,14,'1989-02-03 12:50:52','1988-09-03 11:17:32'),(23,31,'2004-04-03 22:48:15','1990-10-31 16:13:17'),(24,26,'1970-09-08 11:09:21','1973-02-04 09:50:23'),(25,48,'1992-02-15 04:30:24','1983-01-05 20:08:52'),(26,24,'1977-10-23 10:34:55','1993-09-12 13:54:33'),(27,13,'2005-05-25 01:26:29','1982-01-01 18:40:18'),(28,5,'2009-10-14 16:47:55','2004-03-15 02:29:57'),(29,8,'2015-09-27 10:00:41','1988-03-09 23:24:39'),(30,29,'1988-04-02 20:15:37','2013-03-09 15:29:33'),(31,38,'1992-02-22 00:57:14','1985-07-11 01:38:13'),(32,4,'2000-02-29 19:01:52','2017-03-02 11:34:58'),(33,32,'2011-07-06 12:11:04','1984-05-17 18:38:23'),(34,34,'1999-07-05 22:29:37','1988-03-11 17:33:31'),(35,48,'2010-08-28 23:54:01','1989-03-15 08:51:07'),(36,32,'1975-08-15 20:07:10','2010-02-09 18:35:30'),(37,22,'1991-06-07 16:31:08','2016-07-05 17:16:11'),(38,7,'1980-10-12 07:46:03','1981-04-02 14:19:51'),(39,15,'2002-07-18 20:36:46','2016-12-04 05:22:55'),(40,28,'1993-09-14 16:06:02','1996-02-20 06:55:53'),(41,28,'2014-10-08 11:20:03','2009-07-19 08:51:05'),(42,14,'2019-03-15 01:14:45','1976-01-04 04:18:34'),(43,34,'1995-10-28 13:08:02','1998-03-30 07:34:21'),(44,40,'2014-10-04 04:26:12','1973-10-21 14:19:09'),(45,18,'1979-02-02 08:09:45','1972-04-10 17:59:32'),(46,42,'1977-07-05 19:14:22','2004-06-04 00:31:49'),(47,4,'2012-01-20 01:06:16','1992-09-24 01:15:23'),(48,21,'2000-07-17 06:25:01','1985-10-13 07:15:13'),(49,22,'1984-05-22 13:30:40','1989-01-13 21:46:07'),(50,24,'2009-12-07 22:55:19','2004-04-21 17:09:56'),(51,27,'2017-09-25 07:20:26','1981-09-29 07:40:58'),(52,16,'1975-12-26 15:21:03','1988-06-05 07:28:45'),(53,31,'2020-01-10 19:24:47','2015-11-15 20:37:21'),(54,7,'1986-02-12 21:35:50','1970-03-02 13:04:54'),(55,34,'2000-09-12 17:49:56','1999-01-22 17:43:42'),(56,23,'2014-08-30 02:04:38','2008-10-05 15:25:57'),(57,21,'2020-10-13 02:13:17','1988-11-26 12:15:32'),(58,39,'2021-07-28 01:24:54','2003-03-29 21:48:49'),(59,39,'2017-12-05 17:00:53','1999-08-07 12:59:29'),(60,8,'2007-03-26 13:28:14','2005-06-24 06:01:55'),(61,7,'1997-03-04 18:02:45','2017-12-23 18:33:18'),(62,36,'2019-07-06 17:09:45','2020-03-16 16:43:06'),(63,32,'2017-10-30 15:41:39','2021-04-24 06:42:51'),(64,28,'2012-10-23 19:46:05','1997-04-02 02:18:33'),(65,8,'1986-08-10 15:05:21','2018-09-21 17:36:29'),(66,40,'1977-01-18 06:23:47','1989-11-12 06:48:30'),(67,18,'1980-06-05 23:18:13','2015-12-25 09:55:42'),(68,49,'1992-07-28 10:38:38','2012-02-21 12:23:02'),(69,26,'2013-07-14 19:58:32','1980-05-10 04:37:28'),(70,36,'1975-10-03 13:38:59','1986-02-26 09:26:45'),(71,2,'1977-10-19 12:09:04','1991-10-04 04:12:03'),(72,2,'2010-07-24 07:34:24','1996-11-06 18:39:48'),(73,33,'2000-12-18 16:51:18','1970-11-29 10:12:51'),(74,47,'1983-03-28 22:35:08','1986-06-19 18:04:03'),(75,6,'2021-04-27 00:19:27','1985-07-22 20:29:17'),(76,22,'2000-12-03 03:32:00','1978-05-24 14:56:16'),(77,21,'2002-08-17 18:05:33','2010-01-28 23:20:14'),(78,43,'1972-06-14 18:50:42','1988-05-06 05:30:15'),(79,1,'2016-11-20 14:58:57','1980-08-24 07:58:12'),(80,23,'2002-06-23 15:28:17','1993-11-01 16:24:43'),(81,48,'1970-12-13 08:27:08','2007-02-03 07:53:11'),(82,21,'1977-10-27 09:25:52','2015-11-15 11:43:12'),(83,43,'2009-03-25 19:05:22','1980-08-16 05:05:20'),(84,38,'1988-09-12 21:05:54','1972-06-22 10:19:08'),(85,10,'2010-01-20 12:45:28','1987-06-08 10:35:10'),(86,14,'1994-06-12 01:10:46','1972-08-13 01:31:46'),(87,26,'1992-03-07 13:02:45','1995-09-15 10:52:05'),(88,1,'2019-06-29 23:41:34','2007-08-09 22:04:28'),(89,16,'2012-08-06 05:19:35','1987-11-09 08:19:51'),(90,33,'1999-12-14 00:39:06','2020-11-13 08:46:42'),(91,21,'2008-10-12 02:45:58','1998-05-03 14:50:56'),(92,33,'2016-04-09 00:59:18','1999-07-01 19:28:40'),(93,19,'1995-12-06 17:30:42','2012-01-13 11:42:06'),(94,12,'1996-12-05 15:51:28','1999-03-22 15:58:27'),(95,38,'2001-05-08 07:21:59','2019-05-11 19:28:24'),(96,19,'1985-02-10 14:21:36','1998-10-21 02:51:33'),(97,22,'1981-08-16 18:14:22','1988-08-08 07:50:55'),(98,41,'2006-01-26 00:04:35','1977-07-02 17:16:19'),(99,6,'1974-08-01 05:20:59','2015-10-10 21:29:48'),(100,48,'2007-06-20 19:49:53','1998-12-14 19:24:18'),(101,30,'1983-01-25 00:29:59','2006-04-01 01:34:50'),(102,27,'1973-11-09 22:01:20','2015-10-12 15:41:18'),(103,18,'1970-10-03 10:09:15','1989-11-27 21:32:33'),(104,5,'2005-02-18 17:00:30','1991-02-28 09:31:59'),(105,45,'2002-02-03 16:45:45','1981-09-14 13:10:59'),(106,21,'2011-02-27 13:58:30','1993-09-23 05:25:08'),(107,45,'1971-05-26 08:48:53','2020-02-13 13:28:30'),(108,30,'1971-01-11 02:16:18','1993-11-17 01:11:19'),(109,16,'2005-07-31 09:45:02','2016-06-08 00:58:05'),(110,31,'1996-04-08 17:31:51','1982-11-21 02:27:37'),(111,5,'1971-02-04 05:55:53','1980-02-13 07:09:33'),(112,32,'2014-02-05 01:50:25','1974-07-05 17:16:38'),(113,29,'1982-08-05 06:15:36','1986-11-08 07:00:44'),(114,44,'1972-11-17 23:43:22','1977-10-14 17:13:01'),(115,45,'1985-12-15 12:43:24','1975-06-09 08:25:56'),(116,41,'1994-05-16 14:55:21','1999-01-15 07:40:48'),(117,37,'2016-06-09 22:49:20','1993-03-14 09:42:05'),(118,8,'1984-07-10 13:13:50','2000-12-26 20:26:24'),(119,42,'2000-02-24 17:44:34','1977-05-27 01:30:55'),(120,29,'2005-03-09 23:32:55','1986-08-08 16:59:42'),(121,15,'2017-04-28 21:47:19','1978-11-21 03:25:30'),(122,3,'2001-11-24 19:18:29','1981-07-27 04:53:20'),(123,3,'2017-02-12 06:07:12','1999-05-09 01:15:24'),(124,23,'2002-03-28 21:25:29','2017-06-20 02:36:46'),(125,11,'1980-06-10 22:22:41','1997-04-07 10:25:21'),(126,6,'1972-05-02 11:39:03','2008-12-01 17:08:06'),(127,30,'2011-09-18 14:38:09','2011-01-28 13:29:45'),(128,49,'2004-09-15 23:07:50','1983-04-13 12:34:47'),(129,45,'2020-05-26 07:18:10','1973-10-17 06:45:44'),(130,33,'2007-12-17 07:51:41','1981-12-19 18:21:46'),(131,8,'2012-05-23 17:20:46','1994-12-25 15:27:31'),(132,24,'1985-09-01 14:05:24','2000-09-20 03:52:28'),(133,23,'1995-09-30 16:41:55','2021-02-15 22:49:10'),(134,15,'2021-03-09 00:08:51','1982-08-29 05:15:39'),(135,19,'2019-04-10 04:42:34','1978-06-29 20:16:40'),(136,45,'1984-04-26 11:50:00','1984-04-08 16:35:48'),(137,31,'2014-02-10 05:29:55','1974-04-12 16:39:00'),(138,9,'1998-12-28 22:00:50','2007-11-22 23:33:31'),(139,34,'1998-04-24 06:23:51','1995-12-16 02:32:10'),(140,23,'2009-09-16 03:43:30','2004-09-08 11:22:20'),(141,24,'1999-01-27 05:10:55','1976-11-13 16:32:12'),(142,12,'1991-09-16 10:36:39','1999-06-27 16:38:02'),(143,50,'2015-01-14 17:56:21','2000-10-04 12:03:39'),(144,50,'2002-01-30 20:58:14','1972-10-22 07:00:23'),(145,30,'2015-02-01 00:13:02','1971-09-26 01:42:25'),(146,3,'1991-09-09 12:21:21','2003-05-31 05:04:07'),(147,8,'2012-03-23 19:20:17','1982-09-29 15:55:03'),(148,19,'1991-10-08 19:50:20','1984-03-07 12:27:12'),(149,15,'1971-03-27 13:46:16','1981-03-22 13:05:22'),(150,16,'1970-10-12 14:52:34','2021-05-01 00:07:31'),(151,20,'2009-04-28 09:19:31','1976-07-02 02:47:54'),(152,31,'2019-06-23 20:36:54','1973-04-01 11:48:50'),(153,9,'1988-10-02 10:29:35','2007-08-17 08:46:12'),(154,2,'1986-09-23 00:37:03','2020-01-29 21:46:23'),(155,44,'1989-07-09 11:53:01','1975-02-09 03:22:26'),(156,11,'2010-08-18 00:51:41','1997-07-15 00:56:20'),(157,27,'2010-09-07 04:41:01','2007-06-06 09:38:10'),(158,12,'1991-03-16 08:51:50','1989-08-28 01:39:05'),(159,47,'1970-10-29 02:12:07','1998-05-02 04:42:35'),(160,31,'1990-11-02 06:27:57','2012-08-09 11:39:33'),(161,28,'1988-02-09 20:07:04','1988-07-29 13:16:12'),(162,33,'1996-05-29 12:39:09','1983-11-25 07:16:31'),(163,32,'1994-02-22 17:30:08','1980-04-09 21:51:13'),(164,42,'1989-09-20 22:23:07','1979-01-06 04:01:00'),(165,3,'1970-02-15 17:40:57','1998-08-15 23:53:12'),(166,22,'2018-11-04 20:56:27','1990-06-07 05:56:36'),(167,37,'1990-03-09 12:05:27','1970-03-07 02:19:50'),(168,38,'1984-04-28 21:22:27','1987-01-21 00:15:48'),(169,45,'2010-02-21 23:39:15','1986-03-29 21:10:42'),(170,46,'1986-08-09 08:52:22','1994-01-02 04:25:44'),(171,17,'1984-07-30 03:05:23','2014-03-09 20:35:29'),(172,13,'1990-12-31 22:15:44','1979-01-28 14:55:29'),(173,24,'2008-08-07 01:05:10','1991-06-01 15:03:36'),(174,5,'2002-08-17 19:57:23','1985-03-16 04:19:11'),(175,39,'1982-08-06 22:33:25','1979-12-19 21:21:17'),(176,49,'2002-05-18 05:29:58','2021-05-26 16:42:50'),(177,20,'2009-03-21 01:53:15','1984-11-05 08:57:37'),(178,42,'1990-12-15 12:54:49','2017-05-02 20:24:58'),(179,25,'2014-09-17 01:37:52','2018-09-09 18:55:18'),(180,20,'1976-09-28 14:50:54','2001-10-20 03:55:01'),(181,32,'1975-06-04 14:10:16','2004-03-05 16:59:47'),(182,29,'2019-02-21 17:16:21','1990-03-29 10:03:03'),(183,27,'2012-10-12 17:56:31','2017-12-21 18:34:16'),(184,41,'1995-05-05 11:13:30','2013-11-28 20:42:51'),(185,42,'1995-04-24 23:59:16','1996-09-29 12:45:37'),(186,32,'2002-02-22 11:34:32','2002-08-11 15:28:13'),(187,19,'1986-03-10 20:02:34','2001-04-23 01:33:27'),(188,33,'2009-11-05 13:53:42','1974-09-05 11:13:23'),(189,9,'1986-01-28 07:08:44','2020-08-02 06:25:56'),(190,30,'1999-08-11 09:07:40','1992-11-06 10:40:51'),(191,22,'1994-01-03 23:02:34','2005-04-14 11:12:44'),(192,37,'1984-07-02 06:50:01','1979-06-30 09:16:16'),(193,30,'1975-02-20 11:27:48','1998-02-14 23:59:42'),(194,12,'1971-12-09 11:30:47','2017-04-27 08:30:11'),(195,27,'2002-08-04 02:33:04','1999-11-10 01:39:48'),(196,46,'1987-06-05 02:03:06','1984-04-20 19:09:35'),(197,18,'1995-08-22 14:43:27','2005-10-30 01:58:15'),(198,12,'1977-10-27 09:37:43','1975-03-25 15:54:37'),(199,41,'2010-09-23 05:05:28','1992-10-17 12:04:57'),(200,7,'1988-03-07 05:23:22','1973-11-11 14:36:27');
-- SELECT user_id, COUNT(user_id) AS total_orders FROM orders GROUP BY user_id ORDER BY total_orders;
-- SELECT user_id, COUNT(user_id) AS total_orders FROM orders GROUP BY user_id HAVING total_orders = 1;
SELECT o.user_id, u.name, COUNT(o.user_id) AS total_orders FROM orders o JOIN users u ON o.user_id = u.id GROUP BY user_id HAVING total_orders = 1;

-- ЗАДАНИЕ 2
-- Выведите список товаров products и разделов catalogs, который соответствует товару.
SELECT * FROM products;
SELECT * FROM catalogs;
SELECT p.name, c.name FROM products p JOIN catalogs c ON p.catalog_id = c.id;

-- ЗАДАНИЕ 3
-- (по желанию) Пусть имеется таблица рейсов flights (id, from, to) и таблица городов cities (label, name). Поля from, to и label содержат английские названия городов, поле name — русское. Выведите список рейсов flights с русскими названиями городов.

CREATE DATABASE airport;
USE airport;
DROP TABLE tbl1;
CREATE TABLE IF NOT EXISTS `flights` (
	`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `from` VARCHAR(255),
    `to` VARCHAR(255)
);
INSERT INTO `flights` (`from`,`to`)
VALUES ('Moscow', 'Omsk'), ('Novgorod', 'Kazan'), ('Ircutsk', 'Moscow'),('Omsk', 'Ircutsk'),('Moscow', 'Kazan');

CREATE TABLE cities (
  `label` VARCHAR(255),
  `name` VARCHAR(255)
);
INSERT INTO `cities` (`label`,`name`)
VALUES ('Moscow', 'Москва'), ('Novgorod', 'Новгород'), ('Ircutsk', 'Иркутск'),('Omsk', 'Омск'),('Kazan', 'Казань');

SELECT f.id, c.name, cc.name FROM flights f JOIN cities c ON f.from = c.label JOIN cities cc ON f.to = cc.label ORDER BY f.id;